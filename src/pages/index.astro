---
---
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Room Sign Editor</title>
  <style>
    :root { --gap: 12px; }
    html, body { margin:0; height:100%; background:#0b0f19; color:#fff; font-family: system-ui, -apple-system, Segoe UI, Inter, Roboto, Arial, sans-serif; }
    .wrap { max-width:1200px; margin:24px auto; padding:0 16px; display:grid; gap:16px; grid-template-columns: 1.2fr .8fr; }
    @media (max-width: 980px){ .wrap{ grid-template-columns: 1fr; } }
    .card { background:#141a2a; border:1px solid #232a45; border-radius:14px; padding:12px; }
    label{ font-size:12px; opacity:.9; display:block; margin-bottom:6px; }
    input, select { width:100%; padding:10px 12px; border-radius:10px; border:1px solid #2a3355; background:#0b0f19; color:#fff; }
    button { cursor:pointer; border:1px solid #2a3355; background:#1a2240; color:#fff; padding:10px 12px; border-radius:10px; }
    .row{ display:grid; grid-template-columns:1fr 1fr; gap:var(--gap); }
    .row3{ display:grid; grid-template-columns:1fr 1fr 1fr; gap:var(--gap); }
    canvas{ width:100%; height:auto; background:#fff; border-radius:10px; border:1px solid #232a45; }
    .hint{ font-size:12px; opacity:.8; margin-top:8px }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <!-- 1600x900 matches the look of your mockup -->
      <canvas id="c" width="1600" height="900" aria-label="preview"></canvas>
    </div>

    <div class="card">
      <div class="row">
        <div>
          <label for="room">Room title</label>
          <input id="room" type="text" placeholder="R105 Projekti S" />
        </div>
        <div>
          <label for="subroom">Sub room</label>
          <input id="subroom" type="text" placeholder="R103" />
        </div>
      </div>

      <div class="row" style="margin-top:var(--gap)">
        <div>
          <label for="status">Status</label>
          <select id="status">
            <option>BUSY</option>
            <option>AVAILABLE</option>
          </select>
        </div>
        <div>
          <label for="time">Time range</label>
          <input id="time" type="text" placeholder="15:00 - 18:00" />
        </div>
      </div>

      <div class="row" style="margin-top:var(--gap)">
        <div>
          <label for="note">Center note</label>
          <input id="note" type="text" placeholder="Your paragraph text" />
        </div>
        <div>
          <label for="date">Date</label>
          <input id="date" type="text" placeholder="dd/mm/yyyy" />
        </div>
      </div>

      <div class="row" style="margin-top:var(--gap)">
        <div>
          <label for="cap">Capacity</label>
          <input id="cap" type="text" placeholder="8 persons" />
        </div>
        <div>
          <label for="aud">Available to</label>
          <input id="aud" type="text" placeholder="Staff, Student" />
        </div>
      </div>

      <div class="row3" style="margin-top:var(--gap)">
        <div>
          <label for="accent">Accent color</label>
          <input id="accent" type="color" value="#bd4c52" />
        </div>
        <div>
          <label for="statusColorBusy">Busy color</label>
          <input id="statusColorBusy" type="color" value="#cf676e" />
        </div>
        <div>
          <label for="statusColorAvail">Available color</label>
          <input id="statusColorAvail" type="color" value="#26a65b" />
        </div>
      </div>

      <div class="row" style="margin-top:var(--gap)">
        <button id="download">Download PNG</button>
        <button id="copy">Copy to clipboard</button>
      </div>

      <p class="hint">
        Share presets via URL, for example:
        <code>?room=R105 Projekti S&sub=R103&status=BUSY&time=15:00%20-%2018:00&cap=8%20persons&aud=Staff,%20Student&date=01/12/2025&note=Your%20paragraph%20text</code>
      </p>
    </div>
  </div>

  <script>
    const c = document.getElementById('c');
    const ctx = c.getContext('2d');

    // State
    const S = {
      room: 'R105 Projekti S',
      sub: 'R103',
      status: 'BUSY',
      time: '15:00 - 18:00',
      note: 'Your paragraph text',
      date: 'dd/mm/yyyy',
      cap: '8 persons',
      aud: 'Staff, Student',
      accent: '#bd4c52',
      busy: '#cf676e',
      avail: '#26a65b',
    };

    const el = {
      room: document.getElementById('room'),
      sub: document.getElementById('subroom'),
      status: document.getElementById('status'),
      time: document.getElementById('time'),
      note: document.getElementById('note'),
      date: document.getElementById('date'),
      cap: document.getElementById('cap'),
      aud: document.getElementById('aud'),
      accent: document.getElementById('accent'),
      busy: document.getElementById('statusColorBusy'),
      avail: document.getElementById('statusColorAvail'),
      download: document.getElementById('download'),
      copy: document.getElementById('copy'),
    };

    // Load from URL params
    const p = new URLSearchParams(location.search);
    if (p.get('room')) S.room = p.get('room');
    if (p.get('sub')) S.sub = p.get('sub');
    if (p.get('status')) S.status = p.get('status').toUpperCase() === 'AVAILABLE' ? 'AVAILABLE' : 'BUSY';
    if (p.get('time')) S.time = p.get('time');
    if (p.get('note')) S.note = p.get('note');
    if (p.get('date')) S.date = p.get('date');
    if (p.get('cap')) S.cap = p.get('cap');
    if (p.get('aud')) S.aud = p.get('aud');
    if (p.get('accent')) S.accent = p.get('accent');
    if (p.get('busy')) S.busy = p.get('busy');
    if (p.get('avail')) S.avail = p.get('avail');

    // Hydrate inputs
    el.room.value = S.room; el.sub.value = S.sub; el.status.value = S.status;
    el.time.value = S.time; el.note.value = S.note; el.date.value = S.date;
    el.cap.value = S.cap; el.aud.value = S.aud;
    el.accent.value = S.accent; el.busy.value = S.busy; el.avail.value = S.avail;

    function draw() {
      // Clear white background
      ctx.fillStyle = '#ffffff';
      ctx.fillRect(0,0,c.width,c.height);

      // Top banner
      const bannerH = 200;
      ctx.fillStyle = S.accent;
      ctx.fillRect(0,0,c.width,bannerH);

      // Room title
      ctx.fillStyle = '#000';
      ctx.textBaseline = 'top';
      ctx.textAlign = 'left';
      ctx.font = '900 120px system-ui, -apple-system, Segoe UI, Inter, Roboto, Arial, sans-serif';
      ctx.fillText(truncate(S.room, 32), 32, 24);

      // Sub room
      ctx.font = '800 56px system-ui, -apple-system, Segoe UI, Inter, Roboto, Arial, sans-serif';
      ctx.fillText(truncate(S.sub, 16), 32, bannerH - 72);

      // Center note
      ctx.textAlign = 'center';
      ctx.font = '600 28px system-ui, -apple-system, Segoe UI, Inter, Roboto, Arial, sans-serif';
      ctx.fillText(trimEmpty(S.note), c.width/2, bannerH + 10);

      // Status block (large)
      ctx.textAlign = 'left';
      const statusColor = S.status === 'AVAILABLE' ? S.avail : S.busy;
      ctx.fillStyle = statusColor;
      ctx.font = '900 160px system-ui, -apple-system, Segoe UI, Inter, Roboto, Arial, sans-serif';
      ctx.fillText(S.status, 32, bannerH + 70);

      // Time under status
      ctx.fillStyle = '#000';
      ctx.font = '900 64px system-ui, -apple-system, Segoe UI, Inter, Roboto, Arial, sans-serif';
      ctx.fillText(S.time, 32, bannerH + 240);

      // Footer
      const footerY = c.height - 80;
      ctx.fillStyle = '#000';
      ctx.textAlign = 'left';
      ctx.font = '600 36px system-ui, -apple-system, Segoe UI, Inter, Roboto, Arial, sans-serif';
      ctx.fillText('Capacity: ' + S.cap, 32, footerY);

      ctx.textAlign = 'center';
      ctx.fillText('Available to: ' + S.aud, c.width/2, footerY);

      ctx.textAlign = 'right';
      ctx.fillText(S.date, c.width - 32, footerY);
    }

    function truncate(s, n){ s = String(s); return s.length > n ? s.slice(0, n-1) + 'â€¦' : s; }
    function trimEmpty(s){ s = String(s || ''); return s.trim() || ''; }

    // Bind inputs
    for (const [k,node] of Object.entries(el)) {
      if (['download','copy'].includes(k)) continue;
      node.addEventListener('input', () => {
        S[k === 'sub' ? 'sub' : k] = node.value;
        if (k === 'status') S.status = node.value.toUpperCase();
        draw();
      });
      node.addEventListener('change', () => {
        S[k === 'sub' ? 'sub' : k] = node.value;
        if (k === 'status') S.status = node.value.toUpperCase();
        draw();
      });
    }

    el.download.addEventListener('click', ()=>{
      const a = document.createElement('a');
      a.download = 'room-sign.png';
      a.href = c.toDataURL('image/png');
      a.click();
    });

    el.copy.addEventListener('click', async ()=>{
      const blob = await new Promise(r => c.toBlob(r, 'image/png'));
      try { await navigator.clipboard.write([new ClipboardItem({ 'image/png': blob })]); alert('Copied to clipboard'); }
      catch(e){ alert('Copy failed. Use Download instead.'); }
    });

    draw();
  </script>
</body>
</html>
